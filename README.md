# Server Preparation Ansible Project

Basic Ansible –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è –¥–ª—è –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–µ—Ä–≤–µ—Ä—ñ–≤. –ö–æ–Ω—Ñ—ñ–≥—É—Ä—É—î –æ—Å–Ω–æ–≤–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ —Ç–∞–∫—ñ —è–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ, SSH, –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏ —Ç–∞ –æ—Å–Ω–æ–≤–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏. –†–æ–∑—Ä–æ–±–ª–µ–Ω–æ –¥–ª—è —Ä–æ–±–æ—Ç–∏ –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö Linux —Ö–æ—Å—Ç–∞—Ö.

## üöÄ –ú–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

- ‚úÖ –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏ —Ç–∞ –ø–∞–∫–µ—Ç—ñ–≤
- ‚úÖ –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å—É —Ç–∞ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó —á–∞—Å—É
- ‚úÖ –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ –∑ SSH –∫–ª—é—á–∞–º–∏
- ‚úÖ –ë–µ–∑–ø–µ—á–Ω–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è SSH
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∞–∑–æ–≤–∏—Ö –ø–∞–∫–µ—Ç—ñ–≤
- ‚úÖ –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Vim –∑ –ø–ª–∞–≥—ñ–Ω–∞–º–∏
- ‚úÖ –ö–∞—Å—Ç–æ–º—ñ–∑–∞—Ü—ñ—è bash prompt

## üìã –í–∏–º–æ–≥–∏

- **Ansible**: >= 2.14
- **–ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ –û–°**: Ubuntu 20.04+, Debian 11+
- **Python**: >= 3.8
- **–î–æ—Å—Ç—É–ø**: SSH –∞–±–æ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π –ø–∞—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø –¥–æ —Ü—ñ–ª—å–æ–≤–∏—Ö —Ö–æ—Å—Ç—ñ–≤

## üîß –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

1. **–ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é:**
```bash
git clone <your-repo-url>
cd server-prep
```

2. **–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö –∫–æ–ª–µ–∫—Ü—ñ–π:**
```bash
ansible-galaxy collection install -r requirements.yml
```

3. **–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –∑–º—ñ–Ω–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞:**
```bash
cp env.example .env
# –í—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ .env —Ñ–∞–π–ª –∑—ñ —Å–≤–æ—ó–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è

### –û–±–æ–≤'—è–∑–∫–æ–≤—ñ –∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞

–°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª `.env` –∑ –Ω–∞—Å—Ç—É–ø–Ω–∏–º–∏ –∑–º—ñ–Ω–Ω–∏–º–∏:

| –ó–º—ñ–Ω–Ω–∞ | –û–ø–∏—Å | –ü—Ä–∏–∫–ª–∞–¥ |
|--------|------|---------|
| `ANSIBLE_USER` | –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –¥–ª—è –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è | `ubuntu` |
| `ANSIBLE_PASSWORD` | –ü–∞—Ä–æ–ª—å –¥–ª—è –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è | `your_password` |
| `NEW_USER` | –Ü–º'—è –Ω–æ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ | `admin` |
| `NEW_USER_PASSWORD` | –ü–∞—Ä–æ–ª—å –Ω–æ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ | `secure_password` |
| `SSH_PUB_KEY` | –ó–º—ñ—Å—Ç SSH –ø—É–±–ª—ñ—á–Ω–æ–≥–æ –∫–ª—é—á–∞ | `ssh-rsa AAAAB3...` |
| `TIMEZONE` | –ß–∞—Å–æ–≤–∏–π –ø–æ—è—Å | `Europe/Kiev` |

### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è inventory

–í—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ `inventory.ini` —Ç–∞ –¥–æ–¥–∞–π—Ç–µ —Å–≤–æ—ó —Å–µ—Ä–≤–µ—Ä–∏:

```ini
[servers]
192.168.1.10
192.168.1.11
example.com

[servers:vars]
ansible_user={{ lookup('env', 'ANSIBLE_USER') }}
ansible_password={{ lookup('env', 'ANSIBLE_PASSWORD') }}
ansible_become_password={{ lookup('env', 'ANSIBLE_PASSWORD') }}
```

## üöÄ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –ü–æ–≤–Ω–µ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è
```bash
./run.sh
```

### –í–∏–±—ñ—Ä–∫–æ–≤–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞ —Ç–µ–≥–∞–º–∏
```bash
# –¢—ñ–ª—å–∫–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏
./run.sh system,updates

# –¢—ñ–ª—å–∫–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è SSH
./run.sh ssh

# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Ç–∞ SSH
./run.sh user,ssh
```

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –±–µ–∑ –∑–º—ñ–Ω (dry-run)
```bash
ansible-playbook -i inventory.ini playbook.yml --check
```

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É

```
‚îú‚îÄ‚îÄ ansible.cfg                 # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è Ansible
‚îú‚îÄ‚îÄ playbook.yml                # –ì–æ–ª–æ–≤–Ω–∏–π playbook
‚îú‚îÄ‚îÄ inventory.ini               # –Ü–Ω–≤–µ–Ω—Ç–∞—Ä —Ö–æ—Å—Ç—ñ–≤
‚îú‚îÄ‚îÄ requirements.yml            # –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –∫–æ–ª–µ–∫—Ü—ñ–π
‚îú‚îÄ‚îÄ .ansible-lint              # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è linting
‚îú‚îÄ‚îÄ env.example                # –ü—Ä–∏–∫–ª–∞–¥ –∑–º—ñ–Ω–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
‚îú‚îÄ‚îÄ run.sh                     # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫—É
‚îî‚îÄ‚îÄ roles/                     # –†–æ–ª—ñ Ansible
    ‚îú‚îÄ‚îÄ system_updates/        # –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏
    ‚îú‚îÄ‚îÄ time_configuration/    # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —á–∞—Å—É
    ‚îú‚îÄ‚îÄ user_management/       # –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏
    ‚îú‚îÄ‚îÄ ssh_setup/            # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è SSH
    ‚îú‚îÄ‚îÄ packages_installation/ # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç—ñ–≤
    ‚îú‚îÄ‚îÄ vim_setup/            # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Vim
    ‚îî‚îÄ‚îÄ bash_config/          # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è bash
```

## üè∑Ô∏è –î–æ—Å—Ç—É–ø–Ω—ñ —Ç–µ–≥–∏

| –¢–µ–≥ | –û–ø–∏—Å |
|-----|------|
| `system`, `updates` | –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏ |
| `time` | –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å—É |
| `user` | –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ |
| `ssh` | –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è SSH |
| `packages` | –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç—ñ–≤ |
| `vim` | –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Vim |
| `bash` | –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è bash |

## üîí –ë–µ–∑–ø–µ–∫–∞

- SSH root –ª–æ–≥—ñ–Ω –≤—ñ–¥–∫–ª—é—á–µ–Ω–∏–π
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è –∑–∞ –ø–∞—Ä–æ–ª–µ–º –≤—ñ–¥–∫–ª—é—á–µ–Ω–∞
- –£–≤—ñ–º–∫–Ω–µ–Ω–æ —Ç—ñ–ª—å–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é –∑–∞ –∫–ª—é—á–∞–º–∏
- –ü–∞—Ä–æ–ª—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Ö–µ—à—É—é—Ç—å—Å—è –∑ SHA512
- –ö–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω—ñ –¥–∞–Ω—ñ –Ω–µ –ª–æ–≥—É—é—Ç—å—Å—è

## üìù –õ—ñ—Ü–µ–Ω–∑—ñ—è

–¶–µ–π –ø—Ä–æ–µ–∫—Ç –ª—ñ—Ü–µ–Ω–∑–æ–≤–∞–Ω–∏–π –ø—ñ–¥ MIT License - –¥–∏–≤—ñ—Ç—å—Å—è —Ñ–∞–π–ª [LICENSE](LICENSE) –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.

---

**‚ö†Ô∏è –í–∞–∂–ª–∏–≤–æ**: –ó–∞–≤–∂–¥–∏ —Ç–µ—Å—Ç—É–π—Ç–µ –Ω–∞ –Ω–µ-–ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–∞—Ö –ø–µ—Ä–µ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º —É –≤–∏—Ä–æ–±–Ω–∏—á–æ–º—É —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ!